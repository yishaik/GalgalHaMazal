# גלגל המזל – תיק פרויקט מלא

## מבוא

מערכת **גלגל המזל** היא מיצב טכנולוגי‑אמנותי הכולל טבעת LED בקוטר 10 מטר, מטריצה מרכזית ומנגנון חיישנים המזהה את כיוון ומהירות הסיבוב. תיק זה מרכז את כל הקבצים הדרושים לבניית המערכת, וכן מפרט טכני מפורט של כל מחבר, חוט, נגד, קבל וברגים מומלצים.

התיק נועד לשמש בסיס לעבודה ולתחזוקה, ומאפשר גישה מהירה לתרשימי החיווט, לרשימת החלקים (Bill of Materials) ולהוראות ההרכבה.

## מבנה התיק

| קובץ/תיקיה | תיאור |
|---|---|
| **diagram_mermaid.html** | תרשים חיווט כללי בפורמט HTML‑Mermaid. מציג את קופסת הבקרה, קופסת הפיצול, לוח הבקרה ורכיבי הגלגל. |
| **Diagram.jsx** | רכיב React המציג מפת חיווט SVG מפורטת, מקרא צבעים ו״כרטיסי״ מפרט. ניתן לייבא לקוד React קיים או לפתוח בדפדפן באמצעות Bundler. |
| **מסמך אפיון טכני – גלגל המזל (מעודכן).pdf** | קובץ האפיון המקורי כפי שסופק על ידי המתכנן. מכיל תיאור מערכת, לוגיקה, אלגוריתמים ודרישות נוספות. |
| **BOM.csv** | רשימת רכיבים מלאה (Bill of Materials) בפורמט CSV: קטגוריה, סוג החלק, ערך/מפרט, כמות מומלצת ותיאור קצר. |
| **README.md** | קובץ תיעוד זה. |

## סקירה כללית של המערכת

המערכת נחלקת לארבעה תתי‑מערכות עיקריות:

1. **קופסת הבקרה – חשמל ובטיחות:** ממוקמת בנקודת קיבוע ומכילה כניסת IEC C14, פיוזים ראשיים, מפסק חירום ושני ספקי כוח (24 V ו‑5 V). מעגלי ההספק מוגנים באמצעות פיוזים איטיים ומחוברים לאדמה משותפת.
2. **קופסת הבקרה – פיצול מתחים:** פסי הפצה (Bus Bars) ל‑24 V, 5 V ו‑GND. כל פס מחובר דרך פיוז נפרד לספק המתאים. מהפסים יוצאים כבלים מאסיבים לעבר הטבעת והמטריצה.
3. **לוח הבקרה האלקטרוני:** כולל את המיקרו‑בקרים (Arduino Uno לשליטה ברינג LED, ESP32 Sensor לקריאת חיישני Hall והפעלת המשולש, ESP32 Matrix להפעלת המטריצה וניהול ממשק Web). הלוח כולל נגדי Pull‑up, נגדי תיאום וקבלי פילטור.
4. **רכיבי הגלגל:** טבעת ה‑LED (WS2814 24 V) באורך 10 מ׳ עם 5 נקודות הזרקת כוח ו־160 מקטעים; מטריצה מרכזית בגודל 32×32 (WS2812B 5 V); חיישני Hall ו״משולש״ אור. כל הרכיבים מחוברים באמצעות מחברי GX16‑3 ומחברים עגולים IP65.

תרשים החיווט המצורף מקודד את כבלי ההספק והנתונים בצבעים שונים: **אדום** – V+, **שחור** – GND, **ירוק** – DATA ל‑WS281x, **כחול** – UART/I²C (בין בקרים), **סגול** – חיישני Hall.

## רשימת רכיבים (BOM)

הרכיבים המופיעים בקובץ `BOM.csv` מחולקים לקטגוריות: הספק, בקרה, מחברים, חוטים וכבלים, נגדים וקבלים, רכיבי תאורה וחיישנים, וברגים/חלקים מכניים. מומלץ לפתוח את הקובץ בעורך טבלאות לקבלת תצוגה ברורה. להלן תמצית עיקרית:

### ספקי כוח והגנות

* **IEC C14 עם מפסק** – כניסת מתח 230 V AC; כולל מפסק ראשי לשבירת המעגל.
* **פיוזים 5×20 מ״מ איטיים** – T‑10A לקו 24 V; T‑15A לקו 5 V; מומלץ להתקין קרוב לספקים.
* **ספק 24 V/15 A (כ‑300 W)** – מספק מתח ל‑WS2814 ואביזרים הדורשים 24 V.
* **ספק 5 V/60 A** – מספק מתח למטריצה, לבקרים ולחיישנים.
* **דיודות TVS** – להגנה מברקים ונחשולי מתח; להצבה בקווי DATA ו‑V+.

### מחברים וכבלים

* **פסי הפצה (Bus Bars)** – למסילות 24 V, 5 V ו‑GND. זרועות מתחברים אליהם באמצעות כבלים עבים (1.5–2.5 מ״מ²). רצוי לבחור פס עם ברגים מסוג M4.
* **מחברים עגולים IP65** – ארבעה מחברי תלת‑פין לתשתית חוץ:
  * מחבר 24 V – מעביר את V+ (כבל 12 AWG) וה‑GND לטבעת;
  * מחבר 5 V – מעביר את V+ (AWG12) וה‑GND למטריצה;
  * מחבר DATA – מעביר את קו הנתונים (כבל CAT6/22 AWG מסוכך) לטבעת;
  * מחבר **SENSOR** – מעביר את 5 V, GND ואות חיישן ל‑Hall sensors.
* **מחברי GX16‑3** – מחברים עגולים משולבים (3 פינים) לשילוב כוח+נתונים:
  * GX16‑3 לטבעת 24 V: Pin 1=+24 V, Pin 2=GND, Pin 3=DATA;
  * GX16‑3 למטריצה 5 V: Pin 1=+5 V, Pin 2=GND, Pin 3=DATA.
* **JST‑SM 3‑Pin** – לחיבור פסי LED WS281x. יש לשמור עקביות: 1=V+, 2=DATA, 3=GND (לפי סימון החץ/IN).
* **JST‑XH 3‑Pin** – לחיבור חיישני Hall: VCC (5 V או 3.3 V), GND ו‑SIG.
* **כבלים** –
  * **הספק**: כבלים דו‑גידיים אדום/שחור בקוטר 1.5–2.5 מ״מ² (AWG16–14) לחיבורי 24 V ו‑5 V;
  * **GND ראשי**: כבל 2.5 מ״מ² לחיבור כל האדמות יחד;
  * **DATA WS281x**: כבל מסוכך 22 AWG + נגד 330 Ω בטור + קבל 1000 µF בקצה המטריצה;
  * **Hall sensors**: כבל מסוכך 3 ליבות 22–24 AWG עד 2 מ׳;
  * **UART/I²C**: זוג שזור 24–26 AWG לחיבור בין Arduino ל‑ESP32 Sensor.

### בקרים וחיישנים

* **Arduino Uno** – שולט בטבעת WS2814 ומקבל פקודות מ‑ESP32 Sensor דרך UART. יש להשתמש בספריות FastLED/NeoPixel ייעודיות ל‑24 V.
* **ESP32 Sensor** – קורא את חיישני A3144, מפעיל את המשולש ומתקשר עם ESP32 Matrix באמצעות ESP‑NOW.
* **ESP32 Matrix** – מפעיל את מטריצת 32×32 WS2812B ומארח ממשק Web לניהול ואנימציות.
* **חיישני Hall A3144** – שני חיישנים לזיהוי כיוון ומהירות; מחוברים באמצעות נגדי Pull‑up 4.7 kΩ.
* **מגנטים** – 32 מגנטים המפוזרים בהיקף ומשולש Doublet לציון נקודת אפס.

### נגדים וקבלים

| רכיב | ערך | שימוש |
|---|---|---|
| **נגד סדרתי ל‑DATA** | 330 Ω | משופר את אמינות קו ה‑DATA ל‑WS281x ומונע צריבת LED. ממוקם קרוב לקצה המקור (Arduino/ESP32). |
| **נגד Pull‑up** | 4.7 kΩ | משמש למשיכת אותות חיישן Hall למתח 5 V/3.3 V. |
| **נגד תיאום** | 1 kΩ | מוריד את זרם יציאה מבקר ה‑DATA כאשר מופעלים מספר פסי LED במקביל. |
| **קבל אלקטרוליטי** | 1000 µF/25 V | מחובר במקביל לאספקה 24 V או 5 V ליד תחילת פסי LED להגנה מנחשולי זרם. |
| **קבל קרמי** | 100 nF | מחובר קרוב לחיישני Hall לסינון רעש. |

### ברגים וחלקים מכניים

המבנה המכנתי דורש תושבת חזקה אך ניתנת לפירוק. מומלץ להשתמש בברגים ונקודות עיגון הבאות:

* **ברגים למיקרו‑בקרים** – ברגי M3×10 מ״מ (עם אום M3 ומפתח פיליפס) לעיגון Arduino ו‑ESP32 ללוח ההתקנה. מומלץ להוסיף מרווחי פלסטיק.
* **ברגים לפסי הפצה ומחברים** – ברגי M4×12 מ״מ עם אומים M4 לקיבוע פסי הפצה, ספקי כוח ומחברי GX16 ללוח.
* **ברגי מסגרת** – בהתקנת הטבעת על מסגרת אלומיניום 6061‑T6, השתמשו בברגי M6 או M8 בהתאם לפרופיל; הברגות אמורות להיות בחוזק 8.8 לפחות.
* **וושרים ונעילה** – שימוש בוושרי קפיץ או אום נעילה ימנע התרופפות עקב ויברציה. הרכיבו באופן אחיד סביב הטבעת.

## הוראות הרכבה והפעלת המערכת

1. **הרכבת הקופסה החשמלית:** התקן את שקע ה‑IEC C14 עם המפסק. חבר את קו ה‑L וה‑N דרך הפיוזים המתאימים אל ספקי הכוח, ודאג לאדמה (PE) משותפת לחלקי המתכת. התקן את מפסק החירום במיקום נגיש.
2. **חיווט הספק:** מחבר 24 V מחובר מהספק דרך פיוז T‑10A אל פס ההפצה. מחבר 5 V יוצא מהספק דרך פיוז T‑15A. השתמש בכבלים בקוטר מינימלי 1.5 מ״מ². חבר את ה‑GND של שני הספקים יחד.
3. **חיווט הבקר:** חבר את Arduino ו‑ESP32 ללוח פס 5 V באמצעות חוטי AWG22–24. חבר את קווי ה‑UART באמצעות זוג שזור. חבר את נגדי ה‑1 kΩ ו‑4.7 kΩ לפי תרשים החיווט.
4. **חיבור הטבעת והמטריצה:** עשה שימוש במחברי GX16‑3 לחיבור הכוח והנתונים לטבעת ולמטריצה. שמור על כבל DATA קצר (≤1 מ׳) ממקור הבקרה עד נקודת IN של ה‑LED. בצע הזרקות כוח כל ~2 מ׳ לטבעת כדי למנוע נפילות מתח.
5. **חיבור חיישני Hall:** התקן את חיישני A3144 במרחק 2–4 מ״מ מהמגנטים; השתמש בכבל מסוכך. חבר את ה‑VCC, GND ו‑SIG למחבר SENSOR. אל תשכח להתקין את הקבל 100 nF קרוב לחיישן.
6. **בדיקות ובטיחות:** לפני הפעלה, בדוק רציפות וחוסר קצר חשמלי. וודא שכל החיבורים מהודקים וברגים נעולים. הפעל את המערכת ללא קהל לצורך בדיקה, וכייל את החיישנים באמצעות הממשק הייעודי.

## הערות וסיכום

תיק פרויקט זה נבנה על סמך התרשימים והמסמך הטכני המצורף. יש להתאים את הערכים בפועל לפי זמינות רכיבים ודרישות בשטח. בעת ביצוע שינויים, חשוב לעדכן את רשימת החומרים ואת התרשימים בהתאם.

לשאלות והבהרות, ניתן לעיין ב״מסמך אפיון טכני – גלגל המזל (מעודכן).pdf״ הכולל פירוט נוסף על הלוגיקה, האלגוריתמים וממשק הבקרה.